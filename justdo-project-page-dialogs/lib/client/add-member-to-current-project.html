<template name="invite_new_user_dialog">
  <div class="invite-new-wrapper {{#if showSelectProjects}}show-select-projects{{/if}}">
    <div class="step-one">
      <div class="step-content">
        <div class="users-email-input-wrapper">
          <input class="users-email-input form-control" placeholder="Type Enter or paste email/s i.e: name@example.com, name2@example.com">
          <button class="users-email-add btn btn-sm btn-primary {{#if showInviteButton}}show{{/if}}" type="button">invite</button>
        </div>
          {{#with groupedUsers}}
            {{#if new_users}}
              {{> batch_add_user_group getUserGroupData grouped_users=new_users group_type="new_users"}}
            {{/if}}
            {{#if registered_users}}
              {{> batch_add_user_group getUserGroupData grouped_users=registered_users group_type="registered_users"}}
            {{/if}}
            {{#if existing_justdo_members}}
              {{> batch_add_user_group getUserGroupData grouped_users=existing_justdo_members group_type="existing_members"}}
            {{/if}}
          {{else}}
            <div class="users-wrapper-empty">No members</div>
          {{/with}}
      </div>
    </div>
    <div class="step-two">
      <div class="step-content">
        <input class="search-tasks form-control" placeholder="Search root tasks / projects">
        <div class="step-title">
          Select root tasks or projects that will be available for new users
        </div>
        <div class="tasks-list">
          <div class="tasks-list-subtitle pt-2">
            Root tasks
          </div>
          {{#if root_tasks}}
            {{#each root_tasks}}
              <div class="task-item {{#if task_is_selected}}selected{{/if}}">
                <strong>#{{seqId}}:</strong> {{title}}
              </div>
            {{/each}}
          {{else}}
            <div class="no-tasks">
              No root tasks found
            </div>
          {{/if}}
          <div class="tasks-list-subtitle pt-3">
            Projects
          </div>
          {{#if projects}}
            {{#each projects}}
              <div class="task-item {{#if task_is_selected}}selected{{/if}}">
                <strong>#{{seqId}}:</strong> {{title}}
              </div>
            {{/each}}
          {{else}}
            <div class="no-tasks">
              No projects found
            </div>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    {{#if showSelectProjects}}
      <button type="button" class="prev btn btn-light">Back</button>
      <button type="button" class="invite btn btn-primary">Invite</button>
    {{else}}
      <button type="button" class="next btn btn-primary {{#if usersExist}}active{{/if}}">Next</button>
    {{/if}}
    <button type="button" class="cancel btn btn-primary">Cancel</button>
  </div>
</template>

<template name="batch_add_user_group">
  <div class="users-section {{getGroupWrapperClassName}}">
    <div class="users-table-header">
      <div class="users-table-header-title">{{getGroupTitle}}</div>
      {{#unless $eq getUserGroupType "existing_members"}}
        <div class="users-table-header-roles">
          Set all as:
          <div class="toolbar-role-item text-primary members-all">Member</div>
          <div class="toolbar-role-item text-primary guests-all">Guest</div>
          {{#if showProxyAll}}
            <div class="toolbar-role-item text-primary proxy-all">Proxy</div>
          {{/if}}
          <div class="toolbar-role-item text-primary role-info" jd-tt="add-new-member-dialog-info">?</div>
        </div>
      {{/unless}}
    </div>
    <div class="users-table-wrapper">
      <table class="users-table table">
        <thead>
          <tr>
            <th class="type">type</th>
            <th class="full-name">full name</th>
            <th class="email">email</th>
          </tr>
        </thead>
        <tbody>
          {{#each grouped_users}}
            <tr class="users-table-item">
            {{> batch_add_user_row getUserRowData}}
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </div>

</template>

<template name="batch_add_user_row">
  <td>
    {{#if isDisabled}}
      <div class="disabled-selection-text">{{role}}</div>
    {{else}}
      <select class="user-type-select form-select form-select-sm {{isDisabled}}">
        {{#if $eq isDisabled "disabled"}}
          <option value={{role}} selected>{{role}}</option>
        {{else}}
          <option value="member" {{isUserTypeSelected "member"}}>Member</option>
          <option value="guest" {{isUserTypeSelected "guest"}}>Guest</option>
          {{#if showProxy}}
            <option value="proxy" {{isUserTypeSelected "proxy"}}>Proxy</option>
          {{/if}}
        {{/if}}
      </select>
    {{/if}}
  </td>
  <td>
    <div class="d-flex">
      {{#if registered}}
        <div class="user-full-name">{{first_name}} {{last_name}}</div>
      {{else}}
        <input class="user-first-name-input form-control form-control-sm last_name_border {{showBorderIfEmpty "first_name"}}" type="text" placeholder="First name" value="{{first_name}}">
        <input class="user-last-name-input form-control form-control-sm last_name_border {{showBorderIfEmpty "last_name"}}" type="text" placeholder="Last name" value="{{last_name}}">
      {{/if}}
    </div>
  </td>
  <td>
    <div class="user-email-wrapper">
      <div class="user-email" title="{{email}}">{{email}}</div>
      <svg class="user-delete jd-icon text-secondary"><use xlink:href="/layout/icons-feather-sprite.svg#x"></use></svg>
    </div>
  </td>
</template>

<template name="task_pane_task_changelog">
  <div class="task-pane-task-changelog">
    <div class="filter-toggle {{#if filterForStatusChanges}}active-filter{{/if}} d-flex align-items-center bg-light p-1 rounded mb-1">
      {{#if filterForStatusChanges}}
        <svg class="jd-icon text-primary"><use xlink:href="/layout/icons-feather-sprite.svg#toggle-right"/></svg>
      {{else}}
        <svg class="jd-icon text-secondary"><use xlink:href="/layout/icons-feather-sprite.svg#toggle-left"/></svg>
      {{/if}}

      <span class="text-body text-uppercase font-weight-bold jd-c-pointer ml-1">Filter for Notes changes only</span>

    </div>
    {{#if dataLoaded}}
      {{#each changeLogRecords}}
        {{> task_pane_task_changelog_record}}
      {{/each}}
    {{else}}
      <div class="loading">
        {{> general_loading_indicator message="loader_loading"}}
      </div>
    {{/if}}
  </div>
</template>

<template name="task_pane_task_changelog_record">
  {{#unless filtered}}
    <div class="record d-flex py-2">
      <div class="image mr-2 mt-1">{{#with changingUser}}{{> justdo_avatar}}{{/with}}</div>
      <div class="content">
        <div class="data text-body {{#if undone}}undone{{/if}}">
          {{{xssGuard formatedValue}}}
        </div>

        {{#if undoable}}
          <small class="date text-muted">
            Was: {{oldValue}}
            {{#if undone}}
             <br>Reverted on {{userDateFormat undone_on}} by <span jd-tt="user-info?id={{undone_by}}">{{displayName undone_by}}</span>
            {{/if}}
            .
          </small>
          <br>
        {{/if}}
        <div class="d-flex">
          <small class="date text-muted {{#if undone}}undone{{/if}}">{{userDateFormat when}}</small>
          {{#if $and ($not undone) undoable}}
            <small class="undo text-primary">Undo</small>
          {{/if}}
        </div>
      </div>
    </div>
  {{/unless}}
</template>

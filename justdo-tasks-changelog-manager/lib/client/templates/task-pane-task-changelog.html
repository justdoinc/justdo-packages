<template name="task_pane_task_changelog">
  <div class="task-pane-task-changelog">
    <div class="filter-toggle {{#if filterForStatusChanges}}active-filter{{/if}} d-flex align-items-center bg-light p-1 rounded mb-1">
      {{#if filterForStatusChanges}}
        <svg class="jd-icon text-primary"><use xlink:href="/layout/icons-feather-sprite.svg#toggle-right"/></svg>
      {{else}}
        <svg class="jd-icon text-secondary"><use xlink:href="/layout/icons-feather-sprite.svg#toggle-left"/></svg>
      {{/if}}

      <span class="text-body text-uppercase font-weight-bold jd-c-pointer ml-1">Filter for Notes changes only</span>

    </div>
    {{#if dataLoaded}}
      {{#each changeLogRecords}}
        {{> task_pane_task_changelog_record}}
      {{/each}}
    {{else}}
      <div class="loading">
        {{> general_loading_indicator message="Loading..."}}
      </div>
    {{/if}}
  </div>
</template>

<template name="task_pane_task_changelog_record">
  {{#unless filtered}}
    <div class="record d-flex py-2">
      <div class="image mr-2 mt-1">{{#with changingUser}}{{> justdo_avatar}}{{/with}}</div>
      <div class="content">
        {{#if involvesAnotherTask}}
          <div class="data text-body has-parent {{#if undone}}undone{{/if}}" jd-tt="task-info?id={{new_value}}&show-title=true">

            {{formatedValue}}

            {{#if $and ($not undone) undoable}}
              <svg class="undo jd-icon text-secondary"><use xlink:href="/layout/icons-feather-sprite.svg#rotate-ccw"/></svg>
            {{/if}}

          </div>

        {{else}}
          <div class="data text-body {{#if undone}}undone{{/if}}">

            {{formatedValue}}

            {{#if $and ($not undone) undoable}}
              <svg class="undo jd-icon text-secondary"><use xlink:href="/layout/icons-feather-sprite.svg#rotate-ccw"/></svg>
            {{/if}}

          </div>
        {{/if}}

        {{#if undoable}}
          <small class="date text-muted">
            Was: {{oldValue}}
            {{#if undone}}
             - reverted on {{userDateFormat undone_on}}
            {{/if}}
            .
          </small>
          <br>
        {{/if}}

        <small class="date text-muted {{#if undone}}undone{{/if}}">{{userDateFormat when}}</small>
      </div>
    </div>
  {{/unless}}
</template>

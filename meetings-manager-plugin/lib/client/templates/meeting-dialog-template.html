<template name="meetings_meeting_dialog">
  <div class="meetings_meeting-dialog d-flex flex-column rounded shadow-lg">
    <!-- Meeting Header -->
    <div class="meeting-dialog-header">
      <svg class="meeting-dialog-close jd-icon"><use xlink:href="/layout/icons-feather-sprite.svg#x"/></svg>
      <div class="meeting-dialog-state shadow-sm rounded-sm {{#if $eq meeting.status 'pending'}}bg-primary{{/if}} {{#if $eq meeting.status 'in-progress'}}bg-success{{/if}}">{{meeting.status}}</div>
      <div class="meeting-dialog-actions shadow-sm rounded d-flex align-items-center">
        <svg class="jd-icon meeting-print">
          <use xlink:href="/layout/icons-feather-sprite.svg#printer"/>
          <title>Print meeting</title>
        </svg>
        <div class="meeting-dialog-divider bg-secondary"></div>
        <svg class="jd-icon meeting-email">
          <use xlink:href="/layout/icons-feather-sprite.svg#mail"/>
          <title>Email meeting details</title>
        </svg>
        <div class="meeting-dialog-divider bg-secondary"></div>
        <svg class="jd-icon meeting-copy">
          <use xlink:href="/layout/icons-feather-sprite.svg#copy"/>
          <title>Copy meeting details to the clipboard</title>
        </svg>
      </div>
    </div>

    <!-- Meeting Info -->
    <div class="meeting-dialog-info">
      <div class="meeting-dialog-options d-flex align-items-center">
        <input type="text" name="title" placeholder="Meeting Name" value="{{meeting_title}}" autocomplete="off" class="meeting-dialog-title flex-grow-1">
        <div class="meetings-dialog-options d-flex align-items-center">
          <div class="meeting-date-wrapper">
            <div class="text-primary meeting-date-label">{{labelDate doc.date}}</div>
            <input type="text" name="date" value="{{rawdate doc.date}}" class="meeting-date" readonly="readonly">
          </div>
          <div class="mr-1">,</div>
          <div class="meeting-time-wrapper">
            <div class="text-primary meeting-time-label">Set time</div>
            <input type="text" name="time" class="meeting-time" readonly="readonly">
          </div>
          <!-- <div class="meeting-dialog-divider bg-secondary"></div>
          {{#if doc.locked}}
            <svg class="jd-icon text-primary {{mayLockClass}} meeting-lock"><use xlink:href="/layout/icons-feather-sprite.svg#lock"/></svg>
          {{else}}
            <svg class="jd-icon text-primary {{mayLockClass}} meeting-lock"><use xlink:href="/layout/icons-feather-sprite.svg#unlock"/></svg>
          {{/if}}
          <div class="lock-msg">
            {{#if mayLock}}
              {{#if doc.locked}}
                <span class="msg-main-text">Click to unlock meeting</span>
                <span class="msg-sub-text">let meeting participants to edit the agenda, notes, etc</span>
              {{else}}
                <span class="msg-main-text">Click to lock meeting</span>
                <span class="msg-sub-text">reserve the right to edit the agenda, notes, etc. to yourself</span>
              {{/if}}
            {{else}}
              {{#if doc.locked}}
                <span class="msg-main-text">Meeting is locked</span>
                <span class="msg-sub-text">you can't edit the agenda, notes, etc</span>
              {{else}}
                <span class="msg-main-text">Meeting is unlocked</span>
                <span class="msg-sub-text">you can edit the agenda, notes, etc</span>
              {{/if}}
            {{/if}}
          </div> -->
        </div>
      </div>
      <div class="meeting-members">
        {{#with meeting}}
          {{> meetings_meeting_members}}
        {{/with}}
      </div>
    </div>

    <!-- Meeting Agenda -->
    <div class="meeting-dialog-agenda-title">
      Agenda
      {{#if mayEditAgenda}}
        <svg class="meeting-dialog-add-task text-primary jd-icon"><use xlink:href="/layout/icons-feather-sprite.svg#plus"></use></svg>
      {{/if}}
    </div>
    <div class="meeting-dialog-agenda {{agendaDraftClass}}">
      <div class="meeting-tasks-list">
        {{#unless noRander}}
          {{#each tasks}}
            {{> meetings_dialog_task}}
          {{/each}}
        {{/unless}}
      </div>
      {{#if mayEditAgenda}}
        <div class="meeting-dialog-add-task-wrapper">
          <input type="text" size="6" name="seqId" placeholder="Type task number" autocomplete="off" class="form-control meeting-task-add">
        </div>
      {{/if}}
    </div>

    <!-- Meeting Footer -->
    <div class="meeting-dialog-footer">
      {{#if showMeetingNote}}
        <div class="meeting-note">
          {{> locking_text_editor content=meeting.note class="note" placeholder="Note" lock=meeting.note_lock disabled=mayNotEditMeetingNote onSave=onSaveMeetingNote}}
        </div>
      {{/if}}
      <div class="d-flex align-items-center justify-content-end py-3">
        {{#if mayEdit}}
          {{#if showDiscardButton}}
            <button type="button" class="btn btn-secondary btn-cancel-meeting mr-2">Discard</button>
          {{/if}}
          {{#if $eq meeting.status "draft"}}
            <button type="button" class="btn btn-primary btn-publish-meeting">Publish</button>
          {{/if}}
          {{#if $eq meeting.status "pending"}}
            <button type="button" class="btn btn-primary btn-start-meeting">Start Meeting</button>
          {{/if}}
          {{#if $eq meeting.status "in-progress"}}
            <button type="button" class="btn btn-primary btn-end-meeting">End Meeting</button>
          {{/if}}
          {{#if $eq meeting.status "adjourned"}}
            <div class="done-msg">Meeting finished, you can reopen meeting to edit</div>
            <button type="button" class="btn btn-secondary btn-start-meeting">Reopen</button>
          {{/if}}
        {{/if}}
      </div>
    </div>




    <!-- =============================================================================== -->

    <div>
      <!-- AGENDA HEADER -->
      <div class="agenda-header d-flex align-items-center justify-content-between py-2 {{agendaDraftClass}}">
        {{#if mayEditAgenda}}
          <div class="meeting-add-task d-flex">
            <input type="text" size="6" name="seqId" value="{{doc.seqId}}" placeholder="Type task number" class="form-control form-control-sm meeting-task-add">
            <button class="btn btn-light btn-sm text-nowrap border ml-2 add-task-btn">Add Task</button>
          </div>
        {{/if}}
      </div>
      <!-- AGENDA BODY -->
      <div class="meeting-tasks bg-light border-top border-bottom {{agendaDraftClass}}">
        <div class="meeting-tasks-list p-2">
          {{#unless noRander}}
            {{#each tasks}}
              {{> meetings_dialog_task}}
            {{/each}}
          {{/unless}}
        </div>
        {{#if showMeetingNote}}
          <div class="meeting-note">
            {{> locking_text_editor content=meeting.note class="note" placeholder="Note" lock=meeting.note_lock disabled=mayNotEditMeetingNote onSave=onSaveMeetingNote}}
          </div>
        {{/if}}
      </div>

      <!--Adding new task-->
      <!--{{#if mayEdit}}-->
        <!--<div class="meeting-add-task">-->
          <!--<div class="row">-->
            <!--<div class="col-sm-4">-->
              <!--<div class="form-group">-->
                <!--<label>Task #</label>-->
                <!--<input type="text" name="seqId" value="{{doc.seqId}}" class="form-control" placeholder="Task #">-->
              <!--</div>-->
            <!--</div>-->
            <!--<div class="col-sm-4">-->
              <!--<button type="button" class="add-task-btn btn btn-primary">Add Task</button>-->
            <!--</div>-->
          <!--</div>-->
        <!--</div>-->
      <!--{{/if}}-->

      {{#if errors}}
        <div class="errors">
          {{#each errors}}
            <div class="error">{{message}}</div>
          {{/each}}
        </div>
      {{/if}}
    </div>

    <div class="discard-msg">
      <div class="discard-msg-content">
        <label class="control-label">Discard this meeting?</label>
        <div class="form-group">
          <button type="button" class="btn btn-primary btn-discard-ok" data-dismiss="modal">Yes</button>
          <button type="button" class="btn btn-default btn-discard-no">No</button>
        </div>
      </div>
    </div>
  </div>
</template>
